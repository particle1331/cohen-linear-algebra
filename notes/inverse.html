
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Matrix inverse and pseudoinverse &#8212; computational-linear-algebra</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/loss_surface.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/loss_surface.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">computational-linear-algebra</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  FUNDAMENTALS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vectors-and-matrices.html">
   Vectors and matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd.html">
   Singular value decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mm-norms.html">
   Matrix multiplication and norms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rank.html">
   Rank and dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="four-subspaces.html">
   Four fundamental subspaces
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notes/inverse.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/particle1331/machine-learning-collection"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/particle1331/machine-learning-collection/issues/new?title=Issue%20on%20page%20%2Fnotes/inverse.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="matrix-inverse-and-pseudoinverse">
<h1>Matrix inverse and pseudoinverse<a class="headerlink" href="#matrix-inverse-and-pseudoinverse" title="Permalink to this headline">Â¶</a></h1>
<br>
<ul>
<li><p>(7.1) <strong>Full rank iff. invertible.</strong> Let <span class="math notranslate nohighlight">\(\bold A \in \mathbb R^{n \times n}.\)</span> TFAE</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{rank }\bold A = n.\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A\)</span> is one-to-one.</p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A\)</span> is onto.</p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A\)</span> is invertible.</p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A\)</span> is nonsingular.</p></li>
</ol>
<p>This can be proved using the rank-nullity theorem which constrains rank to be <span class="math notranslate nohighlight">\(n\)</span> if and only if the dimension of the null space is zero. The latter is then equivalent to <span class="math notranslate nohighlight">\(\bold A\)</span> being one-to-one, while the former to <span class="math notranslate nohighlight">\(\bold A\)</span> being onto. This proves (1-4). A matrix is nonsingular if it has no nonzero singular value so that the image of the unit sphere under <span class="math notranslate nohighlight">\(\bold A\)</span> is non-degenerate. Note that <span class="math notranslate nohighlight">\(\bold A\)</span> is invertible if and only if <span class="math notranslate nohighlight">\(\bold \Sigma\)</span> is invertible (since <span class="math notranslate nohighlight">\(\bold U\)</span> and <span class="math notranslate nohighlight">\(\bold V\)</span> are invertible). But <span class="math notranslate nohighlight">\(\bold \Sigma\)</span> is invertible if and only if <span class="math notranslate nohighlight">\(r = n,\)</span> and we can take <span class="math notranslate nohighlight">\({\bold\Sigma^{-1}}_ {ii} = \sigma_i^{-1}\)</span> for <span class="math notranslate nohighlight">\(i = 1, \ldots, n.\)</span> Thus, a matrix is invertible if and only if it is nonsingular. This proves (5) <span class="math notranslate nohighlight">\(\iff\)</span> (4).</p>
</li>
</ul>
<br>
<ul>
<li><p>(7.2) <strong>Sparse matrix has a dense inverse.</strong> A sparse matrix can have a dense inverse. This can cause memory errors in practice. In <code class="docutils literal notranslate"><span class="pre">src/9_sparse_to_dense.py</span></code> we artificially construct a sparse matrix. This is typically singular, so we shift it to make it nonsingular.  The result is that the inverse is 50x more dense than the original matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="n">sparsity</span><span class="p">:</span>      <span class="mf">0.001999</span>
<span class="n">A_inv</span> <span class="n">sparsity</span><span class="p">:</span>  <span class="mf">0.108897</span>
</pre></div>
</div>
</li>
</ul>
<br>
<ul>
<li><p>(7.3) <strong>Existence of left and right inverses.</strong> Let <span class="math notranslate nohighlight">\(\bold A \in \mathbb R^{m\times n}.\)</span> TFAE</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{rank }\bold A = n.\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A\)</span> is 1-1.</p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A\)</span> is left invertible.</p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A\)</span> has <span class="math notranslate nohighlight">\(n\)</span> nonzero singular values.</p></li>
</ol>
<p>Itâs easy to see that (1-3) are equivalent and (1) <span class="math notranslate nohighlight">\(\implies\)</span>  (4). We prove (3) <span class="math notranslate nohighlight">\(\impliedby\)</span> (4). Suppose <span class="math notranslate nohighlight">\(\bold A\)</span> has <span class="math notranslate nohighlight">\(n\)</span> nonzero singular values, then we can construct a left inverse using the SVD <span class="math notranslate nohighlight">\(\bold A = \bold U \bold \Sigma \bold V^\top\)</span> which allows us to write
<span class="math notranslate nohighlight">\(
\bold A^\top \bold A = \bold V \bold \Sigma^\top \bold \Sigma \bold V^\top.
\)</span>
This is invertible since <span class="math notranslate nohighlight">\(r = n,\)</span> i.e. <span class="math notranslate nohighlight">\(\bold\Sigma^\top \bold \Sigma\)</span> is <span class="math notranslate nohighlight">\(n \times n\)</span> with nonzero entries on its diagonal. Moreover, the inverse can be efficiently computed using <span class="math notranslate nohighlight">\((\bold A^\top \bold A)^{-1} = \bold V (\bold\Sigma^\top \bold \Sigma)^{-1} \bold V^\top\)</span> where <span class="math notranslate nohighlight">\((\bold\Sigma^\top \bold \Sigma)^{-1} = \bold \Sigma_n^{-2}\)</span> is the diagonal matrix with entries <span class="math notranslate nohighlight">\(\sigma_j^{-2}\)</span> for <span class="math notranslate nohighlight">\(j=1,\ldots, n.\)</span> Then, a left inverse for <span class="math notranslate nohighlight">\(\bold A\)</span> is
$<span class="math notranslate nohighlight">\(
  (\bold A^\top \bold A)^{-1} \bold A^\top.
  \)</span>$</p>
<p>We have corresponding dual equivalences about the rows of <span class="math notranslate nohighlight">\(\bold A.\)</span> In this case, <span class="math notranslate nohighlight">\(\bold A\)</span> is onto, and we have a wide matrix with maximal rows. A right inverse of <span class="math notranslate nohighlight">\(\bold A\)</span> can be constructed as
$<span class="math notranslate nohighlight">\(
\bold A^\top (\bold A \bold A^\top)^{-1}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>(\bold A \bold A^\top)^{-1} = \bold U (\bold \Sigma \bold \Sigma^\top)^{-1} \bold U^\top<span class="math notranslate nohighlight">\( can be efficiently computed as in the left inverse with \)</span>(\bold \Sigma \bold \Sigma^\top)^{-1} = \bold \Sigma_m^{-2}.$</p>
</li>
</ul>
<br>
<ul>
<li><p>(7.4) <strong>Moore-Penrose Pseudo-inverse.</strong> Now that we know how to compute the one sided inverse from rectangular matrices, assuming they have full column rank or full row rank, the big missing piece is what to do with a reduced rank matrix. It turns out that it is possible to find another matrix that is not formally an inverse, but is some kind of a good approximation of what the inverse element should be in a least squares sense (later), i.e. what is called a pseudo-inverse. The <strong>Moore-Penrose pseudo-inverse</strong> for a matrix <span class="math notranslate nohighlight">\(\bold A \in \mathbb R^{m \times n}\)</span> is defined as the unique matrix <span class="math notranslate nohighlight">\(\bold A^+ \in \mathbb R^{n \times m}\)</span> that satisfies the four Penrose equations:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\bold A \bold A^+ \bold A = \bold A\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A^+ \bold A \bold A^+ = \bold A^+\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A \bold A^+\)</span> is symmetric.</p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A^+ \bold A\)</span> is symmetric.</p></li>
</ol>
<p>These properties make <span class="math notranslate nohighlight">\(\bold A^+\)</span> look like an inverse of <span class="math notranslate nohighlight">\(\bold A\)</span>. In fact, if <span class="math notranslate nohighlight">\(\bold A\)</span> is invertible, then <span class="math notranslate nohighlight">\(\bold A^{-1}\)</span> trivially satisfies the equations (also see below for left and right inverses). The Moore-Penrose pseudo-inverse exists (from the SVD below) and is <a class="reference external" href="https://en.wikipedia.org/wiki/Proofs_involving_the_Moore%E2%80%93Penrose_inverse">unique</a> for every rectangular matrix even rank deficient ones.
<br><br>
<strong>Existence.</strong> Consider the SVD <span class="math notranslate nohighlight">\(\bold A = \bold U \bold \Sigma \bold V^\top,\)</span> we naturally take
$<span class="math notranslate nohighlight">\(
  \bold A^{+} = \bold V \bold \Sigma^+ \bold U^\top
\)</span><span class="math notranslate nohighlight">\(
where \)</span>\bold \Sigma^+<span class="math notranslate nohighlight">\( is the unique matrix that satisfies the Penrose equations for \)</span>\bold \Sigma.<span class="math notranslate nohighlight">\( This turns out to be  the diagonal matrix of shape \)</span>n \times m<span class="math notranslate nohighlight">\( that is a block matrix with the upper left block \)</span>\bold \Sigma_r^{-1}<span class="math notranslate nohighlight">\( and zero blocks elsewhere. That is, \)</span>\bold\Sigma^+\bold \Sigma<span class="math notranslate nohighlight">\( and  \)</span>\bold\Sigma\bold \Sigma^+<span class="math notranslate nohighlight">\( with \)</span>\bold I_r<span class="math notranslate nohighlight">\( on the upper left block and zero blocks elsewhere are symmetric, then \)</span>\bold \Sigma \bold\Sigma^+\bold \Sigma = \bold \Sigma<span class="math notranslate nohighlight">\( and \)</span>\bold \Sigma^+ \bold \Sigma \bold \Sigma^+ = \bold \Sigma^+.<span class="math notranslate nohighlight">\( It follows that \)</span>\bold A^+<span class="math notranslate nohighlight">\( is the Moore-Penrose pseudo-inverse for \)</span>\bold A,<span class="math notranslate nohighlight">\( e.g.  \)</span>\bold A \bold A^+ = \bold U_r; {\bold U_r}^\top<span class="math notranslate nohighlight">\( and \)</span>\bold A^+ \bold A = \bold V_r; {\bold V_r}^\top<span class="math notranslate nohighlight">\( are symmetric, and the first two Penrose equations follows from the same two equations for \)</span>\bold \Sigma^+.<span class="math notranslate nohighlight">\( This is precisely how `np.linalg.pinv` calculates the pseudo-inverse \)</span>\bold A^+$:
<br></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">A</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">3.2</span> <span class="o">-</span> <span class="n">A</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span> <span class="c1"># make rank 2</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>                                     
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">s_pinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1e-8</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span> <span class="p">])</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">vT</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">s_pinv</span> <span class="o">@</span> <span class="n">u</span><span class="o">.</span><span class="n">T</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.13374723</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01096947</span><span class="p">,</span>  <span class="mf">0.08071149</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.0228385</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.16845822</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12487767</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.1723587</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.44008068</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40026669</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.13374723</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01096947</span><span class="p">,</span>  <span class="mf">0.08071149</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.0228385</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.16845822</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12487767</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.1723587</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.44008068</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40026669</span><span class="p">]])</span>
</pre></div>
</div>
</li>
</ul>
<br>
<p align="center">
      <img src="img/9_sigma_pseudoinverse.png" width=80%/> <br>
      <b>Figure.</b> Pseudo-inverse of the singular values matrix.
</p> 
<br>
<ul>
<li><p>(7.5) <strong>Moore-Penrose pseudo-inverse as left and right inverse.</strong> Let <span class="math notranslate nohighlight">\(\bold A \in \mathbb R^{m \times n}\)</span> with maximal rank. It turns out the left and right inverses we constructed above is the Moore-Penrose pseudo-inverse of <span class="math notranslate nohighlight">\(\bold A\)</span> in each case:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\bold A^+ = (\bold A^\top \bold A)^{-1} \bold A^\top\)</span> (tall)</p></li>
<li><p><span class="math notranslate nohighlight">\(\bold A^+ = \bold A^\top(\bold A \bold A^\top)^{-1}\)</span> (wide)</p></li>
</ul>
<p>This follows from uniqueness and the fact that the left and right inverses each satisfies the Penrose equations. Any left or right inverse will trivially satisfy the first two equations, but not both the third and fourth! For example:
<br></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">31</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">])</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">])</span>     
<span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="n">A</span> <span class="o">@</span> <span class="n">B</span>       
<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">B</span> <span class="o">@</span> <span class="n">A</span>        
<span class="n">Out</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
</li>
</ul>
<br>
<ul class="simple">
<li><p>(7.6) <strong>An exercise on consistency.</strong> Recall that <span class="math notranslate nohighlight">\(\bold A^+ = \bold V \bold \Sigma^+ \bold U^\top\)</span> uniquely. As an exercise, we want to show that this is consistent with the formula <span class="math notranslate nohighlight">\(\bold A^+ = (\bold A^\top \bold A)^{-1} \bold A^\top\)</span> which is true for matrices with linearly independent columns. We do this for the tall case <span class="math notranslate nohighlight">\(m &gt; n\)</span>, the case where the matrix is wide is analogous. Then
$<span class="math notranslate nohighlight">\(
  \bold A^+ = (\bold A^\top \bold A)^{-1} \bold A^\top
  = \bold V (\bold \Sigma^\top \bold \Sigma)^{-1} \bold \Sigma^\top \bold U^\top.
  \)</span><span class="math notranslate nohighlight">\(
  Since \)</span>\bold \Sigma<span class="math notranslate nohighlight">\( is a tall matrix having linearly independent columns, we have \)</span>\bold \Sigma^+ = (\bold \Sigma^\top \bold \Sigma)^{-1} \bold \Sigma^\top.<span class="math notranslate nohighlight">\( Thus, \)</span>(\bold A^\top \bold A)^{-1} \bold A^\top = \bold V \bold \Sigma^+\bold U^\top.<span class="math notranslate nohighlight">\( We get the same agreement when \)</span>\bold A$ is right invertible. This completes the exercise.</p></li>
</ul>
<br>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ron Medina. Powered by <a href="https://jupyterbook.org">Jupyter Book</a>.<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>